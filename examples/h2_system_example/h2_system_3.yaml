scenario:
  name: "Hydrogen_system_3" # in mosaik so called world
  start_time: '2012-01-01 00:00:00' # ISO 8601 start time of the simulation
  end_time: '2012-01-01 02:00:00' # duration in seconds 
  time_resolution: 900 # time step in seconds (optional). Defaults to 15 minutes (900 s)



models: 
- name: CSVdemand1
  type: CSV
  parameters:
    file_path: './examples/h2_system_example/h2_demand_1.csv'
    delimiter: ','
    date_format: 'YYYY-MM-DD HH:mm:ss'

- name: CSVdemand2
  type: CSV
  parameters:
    file_path: './examples/h2_system_example/h2_demand_2.csv'
    delimiter: ','
    date_format: 'YYYY-MM-DD HH:mm:ss'

- name: CSVthermolyzer_replacement
  type: CSV
  parameters:
    file_path: './examples/h2_system_example/thermolyzer_replacement.csv'
    delimiter: ','
    date_format: 'YYYY-MM-DD HH:mm:ss'

- name: H2_controller
  type: H2Controller2
  inputs:
    demand1: null
    demand2: null
    thermolyzer_out: null
    buffer_available_h2: null
    buffer_free_capacity: null
  outputs:
    dump: 0
    buffer_in: 0
    desired_out: 0
  states:
    valve1_ratio1: 0 
    valve1_ratio2: 0
    valve1_ratio3: 0

- name: H2Buffer1
  type: H2Buffer
  parameters: 
    h2_soc_min: 0
    h2_soc_max: 100
    h2_charge_eff: 100
    h2_discharge_eff: 100
    max_h2: 10
    min_h2: 10
    h2_capacity_tot: 100
  inputs:
    h2_in: null
    desired_out: null
  outputs:
    h2_out: 0
    actual_h2_in: 0
  states:
    soc: 80
    flag: 0
    available_h2: 0
    free_capacity: 0 

- name: compressor1
  type: Compressor
  parameters:
    p_in: 30
    p_out: 400
    T_amb: 293.15
    compressor_eff: 90
    max_power_in: 10
  inputs:
    flow2c: null
  outputs:
    flow_from_c: 0
  states:
    volume_flow_out: 0
    power_req: 0

- name: H2Buffer2
  type: H2Buffer
  parameters: 
    h2_soc_min: 0
    h2_soc_max: 100
    h2_charge_eff: 100
    h2_discharge_eff: 100
    max_h2: 10
    min_h2: 10
    h2_capacity_tot: 100
  inputs:
    h2_in: null
    desired_out: null
  outputs:
    h2_out: 0
    actual_h2_in: 0
  states:
    soc: 80
    flag: 0
    available_h2: 0
    free_capacity: 0  

- name: H2valve1
  type: H2Valve
  parameters:
    valve_eff: 100
    # max_flow: 100
  inputs:
    h2_in: null
    ratio1: 0
    ratio2: 0
    ratio3: 0
  outputs:
    out1: null
    out2: null
    out3: null

- name: H2demand1
  type: H2demand
  parameters:
    units: 1
  inputs:
    demand: null
  states:
    tot_dem: null

- name: H2demand2
  type: H2demand
  parameters:
    units: 1
  inputs:
    demand: null
  states:
    tot_dem: null

connections:

- from: CSVdemand1.demand
  to: H2demand1.demand
- from: CSVdemand2.demand
  to: H2demand2.demand
- from: H2demand1.tot_dem
  to: H2_controller.demand1
- from: H2demand2.tot_dem
  to: H2_controller.demand2

- from: CSVthermolyzer_replacement.h2_gen
# - from: thermolyzer1.h_gen
  to: H2_controller.thermolyzer_out

- from: H2Buffer1.available_h2
  to: H2_controller.buffer_available_h2
- from: H2Buffer1.free_capacity
  to: H2_controller.buffer_free_capacity
- from: H2_controller.buffer_in
  to: H2Buffer1.h2_in
  time_shifted: True
- from: H2_controller.desired_out
  to: H2Buffer1.desired_out
  time_shifted: True

- from: H2Buffer1.h2_out
  to: compressor1.flow2c

- from: compressor1.flow_from_c
  to: H2Buffer2.h2_in


- from: H2Buffer2.h2_out
  to: H2valve1.h2_in

- from: H2_controller.valve1_ratio1
  to: H2valve1.ratio1
  time_shifted: True
- from: H2_controller.valve1_ratio2
  to: H2valve1.ratio2
  time_shifted: True

monitor:
  file: './examples/h2_system_example/h2_system_example3.csv'
  items:

    # - thermolyzer1.h_gen
    #- CSVthermolyzer_replacement.h2_gen
    - H2demand1.tot_dem
    - H2demand2.tot_dem
    
    - H2_controller.valve1_ratio1
    - H2_controller.valve1_ratio2

    - H2valve1.out1
    - H2valve1.out2
    # - Controller.valve2_ratio1
    # - Controller.valve2_ratio2
    - H2_controller.dump
    
    - H2Buffer1.soc
    - H2Buffer1.soc
    # - compressor1.flow_from_c
    # - H2storage1.h2_in
    # - H2storage1.h2_out 
    # - H2storage2.h2_in
    # - H2storage2.h2_out
    # - H2joint1.out
    # - H2joint2.out
